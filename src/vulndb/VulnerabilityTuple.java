package vulndb;

import java.text.MessageFormat;

import db.ServerSoftwareTuple;

public class VulnerabilityTuple implements Comparable<VulnerabilityTuple> {
	private String cve;
	private String name;
	private String version_number;
	private String stack;
	
	public VulnerabilityTuple() {
		
	}

	public String getCVE() {
		return cve;
	}

	public String getSoftware() {
		return name;
	}
	
	public String getVersion() {
		return version_number;
	}

	public String getDependency() {
		return stack;
	}
	
    @Override
    public int compareTo(VulnerabilityTuple other) {
    	int result = cve.compareTo(other.getCVE());
    	if (result != 0)
    		return result;
    	result = name.compareTo(other.getSoftware());
    	if (result != 0)
    		return result;
    	result = version_number.compareTo(other.getVersion());
    	if (result != 0)
    		return result;
    	result = stack.compareTo(other.getDependency());
    	if (result != 0)
    		return result;
        return 0;
    }

    public int compareTo(ServerSoftwareTuple ss) {
    	// TODO: major implementation for matching vulnerability with server software
    	return 0;
    }
    
    public String toString() {
    	return MessageFormat.format("VulnerabilityTuple<ID #{0}, {1} v{2}, {3}>",
    			cve, name, version_number, stack);
    }
}
