package vulndb;

import java.io.File;
import java.text.MessageFormat;
import java.util.Iterator;

public class VulnerabilityReader implements Iterable<VulnerabilityTuple> {
	String vuln_db;

	public VulnerabilityReader(String vuln_db_filepath) {
		vuln_db = vuln_db_filepath;
	}

	@Override
	public Iterator<VulnerabilityTuple> iterator() {
		return new VulnerabilityIterator(vuln_db);
	}

	public String toString() {
		int pos = vuln_db.lastIndexOf(File.pathSeparator);
		String basename;
		if (pos == -1)
			basename = vuln_db;
		else
			basename = vuln_db.substring(pos);

		return MessageFormat.format("VulnerabilityReader<{0}>", basename);
	}
}
